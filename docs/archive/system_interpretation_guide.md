# BTC 방향 예측 시스템 해석 가이드

## 1. 시스템 작동 원리

### 1.1 개별 모델 예측 과정
```
데이터 수집 (실시간) → 특징 생성 → 모델 예측 → 신뢰도 계산
```

각 모델은:
- **시간봉별 데이터 수집**: 15m, 30m, 1h, 4h 각각 다른 패턴
- **방향별 특화**: UP 모델은 상승 신호, DOWN 모델은 하락 신호만 예측
- **14개 앙상블**: XGBoost, LightGBM, CatBoost, Extra Trees 조합
- **가중 투표**: 각 모델의 예측을 정확도로 가중치 부여

### 1.2 합의 예측 프로세스

```python
# 실제 작동 방식 (consensus_prediction.py)
1. 각 모델 예측 수집
   - 1h UP: 79.6% 정확도 → 예측: UP (신뢰도: 0.796)
   - 1h DOWN: 78.7% 정확도 → 예측: DOWN (신뢰도: 0.787)
   - 30m UP: 72.9% 정확도 → 예측: UP (신뢰도: 0.729)
   - ... (모든 모델)

2. 타임프레임별 가중치 적용
   - 4h: 2.5x (장기 추세)
   - 1h: 2.0x (중기 추세)
   - 30m: 1.5x (단기 추세)
   - 15m: 1.0x (노이즈 많음)

3. 최종 합의 계산
   - UP 신호 합계 / DOWN 신호 합계
   - 55% 이상 우세한 방향 선택
   - 55% 미만이면 NEUTRAL
```

## 2. 답변 해석 방법

### 2.1 개별 모델 출력 해석

```
📊 개별 모델 예측
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
deep_ensemble_1h_up        → UP    79.6% (정확도: 79.6%)
deep_ensemble_1h_down      → DOWN  78.7% (정확도: 78.7%)
```

**해석 포인트:**
- **방향 충돌은 정상**: 같은 시간대 UP/DOWN 모델이 다른 신호 = 시장 불확실성
- **정확도 ≠ 현재 신뢰도**: 과거 성과이지 현재 예측 확신도 아님
- **시간대별 차이**: 단기(15m)와 장기(4h) 신호 불일치 = 추세 전환 가능

### 2.2 합의 결과 해석

```
🎯 합의 결과
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
상승 확률: 65.3%
하락 확률: 34.7%
최종 방향: UP
신뢰도: 65.3%
```

**신뢰도별 행동 지침:**

| 신뢰도 | 신호 강도 | 권장 포지션 | 해석 |
|--------|-----------|-------------|------|
| > 70% | 강한 신호 | LARGE | 높은 확신, 추세 명확 |
| 60-70% | 보통 신호 | MEDIUM | 적정 확신, 일반 거래 |
| 55-60% | 약한 신호 | SMALL | 낮은 확신, 보수적 접근 |
| < 55% | 중립 | HOLD | 방향성 없음, 관망 |

### 2.3 시간대별 분석 해석

```
⏰ 최적 거래 시간대 (현재 UTC 15:00)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⭐ 30m UP 최적 시간대! (17:00 UTC)
```

**시간대 활용법:**
- **최적 시간 = 과거 성공률 높음**: 해당 시간대 신호 가중치 UP
- **여러 모델 중첩**: 15m, 30m이 같은 시간 최적 = 더 강한 신호
- **UTC 기준**: 한국시간 = UTC + 9시간

## 3. 실전 활용 전략

### 3.1 신호 필터링 전략

**강한 진입 신호 (모두 충족시):**
1. ✅ 합의 신뢰도 > 65%
2. ✅ 장기 시간대(1h, 4h) 일치
3. ✅ 3개 이상 모델 같은 방향
4. ✅ 최적 시간대

**위험 신호 (하나라도 해당시):**
1. ⚠️ 단기/장기 극단적 불일치
2. ⚠️ 15m만 강한 신호 (노이즈 가능성)
3. ⚠️ 모든 모델 신뢰도 < 60%

### 3.2 포지션 크기 계산

```python
def calculate_position_size(confidence, base_amount=1000):
    """신뢰도 기반 포지션 크기"""
    if confidence >= 0.75:
        return base_amount * 1.5  # 150%
    elif confidence >= 0.70:
        return base_amount * 1.0  # 100%
    elif confidence >= 0.65:
        return base_amount * 0.7  # 70%
    elif confidence >= 0.60:
        return base_amount * 0.5  # 50%
    else:
        return 0  # 진입 안함
```

### 3.3 리스크 관리

**손절 설정:**
- 강한 신호 (>70%): -2% 손절
- 보통 신호 (60-70%): -1.5% 손절
- 약한 신호 (55-60%): -1% 손절

**익절 설정:**
- 15m 신호: +1-2% (단기)
- 30m 신호: +2-3% (단기)
- 1h 신호: +3-5% (중기)
- 4h 신호: +5-10% (장기)

## 4. 실제 예시 해석

### 예시 1: 강한 상승 신호
```
1h UP: 79.6% → UP
1h DOWN: 78.7% → DOWN
4h UP: 75.9% → UP
4h DOWN: 74.1% → DOWN
30m UP: 72.9% → UP
합의: UP 68% (강한 신호)

해석: 장기(4h) + 중기(1h) + 단기(30m) 모두 UP 우세
행동: LARGE 포지션, -2% 손절, +5% 익절
```

### 예시 2: 혼재 신호
```
1h UP: 79.6% → UP
1h DOWN: 78.7% → UP (1h은 UP 우세)
4h UP: 75.9% → DOWN
4h DOWN: 74.1% → DOWN (4h는 DOWN 우세)
합의: NEUTRAL 52%

해석: 단기 상승 vs 장기 하락 충돌
행동: 관망 또는 스캘핑만
```

### 예시 3: 시간대 보정
```
현재: UTC 17:00 (30m UP 최적 시간)
30m UP: 72.9% → UP (가중치 1.5x → 2.0x 상향)
합의: UP 62% → 67% (시간 보정)

해석: 최적 시간대로 신호 강화
행동: MEDIUM 포지션 진입
```

## 5. 주의사항 & 한계

### 5.1 모델의 한계
- **과거 데이터 기반**: 미래 보장 안됨
- **블랙스완 이벤트**: 급격한 뉴스/이벤트 예측 불가
- **15m 노이즈**: 단기 신호는 신뢰도 낮음
- **방향만 예측**: 정확한 가격 목표 없음

### 5.2 활용시 주의점
1. **단독 사용 금지**: 다른 지표와 병행
2. **자금 관리 필수**: 켈리 공식 등 활용
3. **감정 배제**: 시스템 신호 따르기
4. **정기 재훈련**: 시장 변화 반영 필요

### 5.3 개선 가능 영역
- [ ] 거래량 가중치 추가
- [ ] 뉴스/센티먼트 통합
- [ ] 동적 시간대 조정
- [ ] 변동성 기반 손절 조정

## 6. 성능 모니터링

### 실시간 추적 지표
```python
# 일일 성과 추적
- 신호 발생 횟수
- 적중률 (실제 vs 예측)
- 평균 수익률
- 최대 연속 성공/실패
- Sharpe Ratio
```

### 재훈련 시점
- 정확도 5% 이상 하락시
- 30일 경과시
- 시장 체제 변화시 (불/베어 전환)

---

**💡 핵심 요약:**
1. 여러 모델의 합의가 핵심 - 단일 모델 맹신 금지
2. 시간대별 가중치 고려 - 장기 > 단기
3. 신뢰도 기반 포지션 조절 - 확신도에 따라 베팅
4. 시장 상황 고려 - 변동성 높을때는 보수적으로
5. 지속적 모니터링 - 성과 추적하고 개선